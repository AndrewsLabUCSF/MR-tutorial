{
  "hash": "5946fad140caf5365d3ee2c700e67af8",
  "result": {
    "markdown": "---\nformat: html\neditor: source\neditor_options: \n  chunk_output_type: console\nexecute: \n  freeze: auto\nproject:\n  execute-dir: project\n---\n\n\n# Genetic Correlations\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Load R Packages\"}\nlibrary(tidyverse)    # Data wrangling \nlibrary(GenomicSEM)  \n```\n:::\n\n\n## Methods \n### Tools & Publications \nR, [GenomicSEM](https://rpubs.com/MichelNivard/640145), [LDSC](https://github.com/bulik/ldsc), [HDL](https://github.com/zhenin/HDL)\n\n- Bulik-Sullivan, B. et al. An atlas of genetic correlations across human diseases and traits. [Nat Genet 47, 1236–1241 (2015)](https://www.nature.com/articles/ng.3406).\n- Ning, Z., Pawitan, Y. & Shen, X. High-definition likelihood inference of genetic correlations across human complex traits. [Nat Genet 52, 859–864 (2020)](https://pubmed.ncbi.nlm.nih.gov/32601477/).\n\nGenetic correlation (rg) refers to the degree to which the genetic determinants of two traits overlap - the proportion of variance that two traits share due to genetic causes. A positive genetic correlation between two traits implies that the same genetic variants are influencing both traits in the same direction. Conversely, a negative genetic correlation implies that the genetic variants influencing one trait are having the opposite effect on the other trait. \n\n**LDSC:** Linkage disequilibrium score regression (LDSC) leverages linkage disequilibrium (LD), the non-random association of alleles at different loci, to estimate genetic correlations between two traits. This method operates on the premise that single nucleotide polymorphisms (SNPs) with a higher count of LD partners (thus having a higher LD score) are typically more associated with a trait due to polygenicity, a condition where numerous genetic variants each exert a minor effect.\n\n\n**HDL:** High-definition likelihood (HDL) provides genetic correlation estimates that have higher accuracy and precision compared to LDSC. HDL achives this by using a full likelihood-based method that leverages LD information across the whole genome, where as LDSC only use partial information. \n  \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Munge GWAS SumStats\"}\n## Summary statistics \nWiller2013ldl = \"resources/Willer2013ldl.chrall.CPRA_b37.tsv.gz\"\nGraham2021ldl = \"resources/Graham2021ldl.chrall.CPRA_b37.tsv.gz\"\nKunkleAD = \"resources/Kunkle2019load_stage123.chrall.CPRA_b37.tsv.gz\"\nBellenguezAD = \"resources/Bellenguez2022load.chrall.CPRA_b37.tsv.gz\"\n\n## LD Structure \nld_path = \"resources/eur_w_ld_chr/\"\n\n## HAPMAP3 SNPs\nhm3_path = \"resources/w_hm3.snplist\"\n\n\nGenomicSEM::munge(\n  files = c(Willer2013ldl, Graham2021ldl, KunkleAD, BellenguezAD), \n  hm3 = hm3_path, \n  trait.names = c(\"Willer2013ldl\", \"Graham2021ldl\", \"KunkleAD\", \"BellenguezAD\"), \n  maf.filter = 0.05, \n  column.names = list(\n    SNP='DBSNP_ID', \n    MAF='AF', \n    A1='ALT',\n    A2='REF', \n    effect='BETA', \n    N = \"N\"\n  ), \n  overwrite=FALSE\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"LDSC\"}\nldsc.covstruct <- GenomicSEM::ldsc(\n     traits = c(\"Willer2013ldl.sumstats.gz\", \"Graham2021ldl.sumstats.gz\", \"BellenguezAD.sumstats.gz\", \"KunkleAD.sumstats.gz\"),\n     trait.names = c(\"Willer2013ldl\", \"Graham2021ldl\", \"BellenguezAD\", \"KunkleAD\"), \n     sample.prev = c(NA, NA, 0.18, 0.37),\n     population.prev = c(NA, NA, 0.31, 0.31),\n     ld = ld_path, \n     wld = ld_path,\n     stand = TRUE\n     )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"HDL\"}\nhdl.covstruct <- GenomicSEM::hdl(\n     traits = c(\"Willer2013ldl.sumstats.gz\", \"Graham2021ldl.sumstats.gz\", \"BellenguezAD.sumstats.gz\", \"KunkleAD.sumstats.gz\"),\n     trait.names = c(\"Willer2013ldl\", \"Graham2021ldl\", \"BellenguezAD\", \"KunkleAD\"), \n     sample.prev = c(NA, NA, 0.18, 0.37),\n     population.prev = c(NA, NA, 0.31, 0.31),\n     LD.path=\"resources/UKB_imputed_hapmap2_SVD_eigen99_extraction/\", \n     method = \"piecewise\"\n     )\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}