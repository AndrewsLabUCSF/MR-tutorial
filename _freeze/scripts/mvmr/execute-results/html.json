{
  "hash": "a0534d9f959252d43674b123b3bd66b3",
  "result": {
    "markdown": "---\noutput: html_document\nexecute: \n  freeze: auto\neditor_options: \n  chunk_output_type: console\n---\n\n\n# Multivariable MR\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Load R Packages\"}\nlibrary(tidyverse)    # Data wrangling \nlibrary(cowplot)\nlibrary(TwoSampleMR)  # MR \nlibrary(LDlinkR)      # LD and proxy snps\nlibrary(RadialMR)     # Radial MR sensetivity analysis \nlibrary(phenoscanner) # Phenoscaner\nlibrary(MVMR)         # Multivarble MR\nlibrary(RMVMR)\nlibrary(gt)\n```\n:::\n\n\n## Perform MR analysis \n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Import Data\"}\n# Define column types for summary statistics\ncoltypes = cols(\n  ID = col_character(),\n  CHROM = col_double(),\n  POS = col_double(),\n  REF = col_character(),\n  ALT = col_character(),\n  AF = col_double(),\n  TRAIT = col_character(),\n  BETA = col_double(),\n  SE = col_double(),\n  Z = col_double(),\n  P = col_double(),\n  N = col_double(),\n  OR = col_double(),\n  OR_L95 = col_double(),\n  OR_U95 = col_double(),\n  DIR = col_character(),\n  G1000_ID = col_character(),\n  G1000_VARIANT = col_character(),\n  DBSNP_ID = col_character(),\n  DBSNP_VARIANT = col_character(),\n  OLD_ID = col_character(),\n  OLD_VARIANT = col_character()\n)\n\n## Function for extracting proxy snps using LDLink\nmunge_proxies <- function(LDLink_file, outcome, outcome_clump){\n  LDLink_file_path <- LDLink_file\n  proxy_snps <- read_tsv(LDLink_file_path, skip = 1, col_names = F) %>%\n    rename(id = X1, func = X2, proxy_snp = X3, coord = X4, alleles = X5, maf = X6, \n           distance = X7, dprime = X8, rsq = X9, correlated_alleles = X10, FORGEdb = X11, RegulomeDB = X12) %>%\n    separate(coord, c('chr', 'pos'), sep = \":\") %>%\n    mutate(snp = ifelse(id == 1, proxy_snp, NA), \n           chr = str_replace(chr, 'chr', \"\"), \n           chr = as.numeric(chr), \n           pos = as.numeric(pos)) %>%\n    fill(snp, .direction = 'down') %>%\n    relocate(snp, .before = proxy_snp) %>%\n    dplyr::select(-id, -func, -FORGEdb, -RegulomeDB) %>%\n    filter(rsq >= 0.8)\n\n  # Munge proxy snp and outcome data\n  proxy_outcome <- left_join(\n      proxy_snps, outcome, by = c(\"proxy_snp\" = \"SNP\")\n    ) %>%\n      separate(correlated_alleles, c(\"target_a1.outcome\", \"proxy_a1.outcome\", \n                                     \"target_a2.outcome\", \"proxy_a2.outcome\"), sep = \",|=\") %>%\n      filter(!is.na(chr.outcome)) %>%\n      arrange(snp, -rsq, abs(distance)) %>%\n      group_by(snp) %>%\n      slice(1) %>%\n      ungroup() %>%\n      mutate(\n         proxy.outcome = TRUE,\n         target_snp.outcome = snp,\n         proxy_snp.outcome = proxy_snp, \n      ) %>% \n      mutate(\n           new_effect_allele.outcome = case_when(\n            proxy_a1.outcome == effect_allele.outcome & proxy_a2.outcome == other_allele.outcome ~ target_a1.outcome,\n            proxy_a2.outcome == effect_allele.outcome & proxy_a1.outcome == other_allele.outcome ~ target_a2.outcome,\n            TRUE ~ NA_character_\n         ), \n          new_other_allele.outcome = case_when(\n            proxy_a1.outcome == effect_allele.outcome & proxy_a2.outcome == other_allele.outcome ~ target_a2.outcome,\n            proxy_a2.outcome == effect_allele.outcome & proxy_a1.outcome == other_allele.outcome ~ target_a1.outcome,\n            TRUE ~ NA_character_\n         ), \n         effect_allele.outcome = new_effect_allele.outcome, \n         other_allele.outcome = new_other_allele.outcome\n      ) %>%\n      dplyr::select(-proxy_snp, -chr, -pos, -alleles, -maf, -distance, -rsq, -dprime,  \n             -new_effect_allele.outcome, -new_other_allele.outcome) %>%\n      relocate(target_a1.outcome, proxy_a1.outcome, target_a2.outcome, proxy_a2.outcome, .after = proxy_snp.outcome) %>%\n      rename(SNP = snp) %>%\n      relocate(SNP, .after = samplesize.outcome)\n  \n  # Merge outcome and proxy outcomes\n  outcome_dat <- bind_rows(\n    outcome_clump, proxy_outcome\n  ) %>% \n    arrange(chr.outcome, pos.outcome)\n  \n  outcome_dat\n}\n```\n:::\n\n\n\n## Methods\n### Tools & Publications \nR, [MVMR](https://github.com/WSpiller/MVMR), [RMVMR](https://github.com/WSpiller/RMVMR), [TwoSampleMR](https://github.com/MRCIEU/TwoSampleMR), [MendelianRandomization](https://cran.r-project.org/web/packages/MendelianRandomization/index.html)\n\n- Hemani, G. et al. The MR-Base platform supports systematic causal inference across the human phenome. [Elife 7, e34408 (2018)]( https://doi.org/10.7554/eLife.34408)\n- Yavorska, O. O. & Burgess, S. MendelianRandomization: an R package for performing Mendelian randomization analyses using summarized data. [Int J Epidemiol 46, dyx034 (2017)](https://doi.org/10.1093/ije/dyx034).\n- Sanderson, E., Spiller, W. & Bowden, J. Testing and correcting for weak and pleiotropic instruments in two‐sample multivariable Mendelian randomization. [Stat Med 40, 5434–5452 (2021)](https://doi.org/10.1002/sim.9133).\n- Woolf, B., Gill, D., Grant, A. J. & Burgess, S. MVMRmode: Introducing an R package for plurality valid estimators for multivariable Mendelian randomisation. [medRxiv (2023)](https://www.medrxiv.org/content/10.1101/2023.01.09.23284345v1).\n   \n\n**Multivariable MR:** Used to estimate the causal relationships between multiple exposures and a single outcome. It is particularly useful in situations where multiple exposures are related and have potential inter-related effects on the outcome of interest. MVMR can help to disentangle the complex relationships between these exposures and provide insights into their independent causal effects. Examples of situations where MVMR can be useful include the estimation of the independent effects of related risk factors such as lipid fractions on an outcome, or the assessment of the independent effects of a primary risk factor and a secondary mediator on a disease outcome. \n\n## Import datasets\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Import LDL SumStats\"}\nexposure1_path = \"resources/Willer2013ldl.chrall.CPRA_b37.tsv.gz\"\nexposure1_ss <- read_tsv(exposure1_path, comment = \"##\", col_types = coltypes, \n                       col_select = c(DBSNP_ID, CHROM, POS, REF, ALT, AF, BETA, SE, Z, P, N, TRAIT))\n\n# Format data to TwoSampleMR format\nexposure1 <- exposure1_ss %>%\n  format_data(.,\n    type = \"exposure\",\n    snps = NULL,\n    header = TRUE,\n    phenotype_col = \"TRAIT\",\n    snp_col = \"DBSNP_ID\",\n    beta_col = \"BETA\",\n    se_col = \"SE\",\n    eaf_col = \"AF\",\n    effect_allele_col = \"ALT\",\n    other_allele_col = \"REF\",\n    pval_col = \"P\",\n    samplesize_col = \"N\",\n    z_col = \"Z\",\n    chr_col = \"CHROM\",\n    pos_col = \"POS\",\n    log_pval = FALSE\n) %>%\n  as_tibble()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Import HDL SumStats\"}\nexposure2_path = \"resources/Willer2013hdl.chrall.CPRA_b37.tsv.gz\"\nexposure2_ss <- read_tsv(exposure2_path, comment = \"##\", col_types = coltypes, \n                       col_select = c(DBSNP_ID, CHROM, POS, REF, ALT, AF, BETA, SE, Z, P, N, TRAIT))\n\n# Format data to TwoSampleMR format\nexposure2 <- exposure2_ss %>%\n  format_data(.,\n    type = \"exposure\",\n    snps = NULL,\n    header = TRUE,\n    phenotype_col = \"TRAIT\",\n    snp_col = \"DBSNP_ID\",\n    beta_col = \"BETA\",\n    se_col = \"SE\",\n    eaf_col = \"AF\",\n    effect_allele_col = \"ALT\",\n    other_allele_col = \"REF\",\n    pval_col = \"P\",\n    samplesize_col = \"N\",\n    z_col = \"Z\",\n    chr_col = \"CHROM\",\n    pos_col = \"POS\",\n    log_pval = FALSE\n) %>%\n  as_tibble()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Import AD SumStats\"}\noutcome_path = \"resources/Kunkle2019load_stage123.chrall.CPRA_b37.tsv.gz\"\noutcome_ss <- read_tsv(outcome_path, comment = \"##\",  col_types = coltypes, \n                       col_select = c(DBSNP_ID, CHROM, POS, REF, ALT, AF, BETA, SE, Z, P, N, TRAIT))\n\n# Format outcome\noutcome <- outcome_ss %>%\n  format_data(.,\n    type = \"outcome\",\n    snps = NULL,\n    header = TRUE,\n    phenotype_col = \"TRAIT\",\n    snp_col = \"DBSNP_ID\",\n    beta_col = \"BETA\",\n    se_col = \"SE\",\n    eaf_col = \"AF\",\n    effect_allele_col = \"ALT\",\n    other_allele_col = \"REF\",\n    pval_col = \"P\",\n    samplesize_col = \"N\",\n    z_col = \"Z\",\n    chr_col = \"CHROM\",\n    pos_col = \"POS\",\n    log_pval = FALSE\n) %>%\n  as_tibble()\n```\n:::\n\n\n## Harmonizing SumStats for MVMR\nMVMR involves the simultaneous use of multiple exposures as instrumental variables in the analysis of a single outcome. As such, harmonizing the exposure and outcome datasets for MVMR is a more complex process than in univariable MR as it requires conducting multiple clumping and proxy-variant procedures. The following is a step-by-step guide to harmonizing the exposure and outcome datasets for MVMR using LDL and HDL cholesterol levels as the exposures, and AD as the outcome:\n\n### Exposures\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Clump Exposure datasets\"}\n# Clump ldl\nexposure1_clump <- exposure1 %>% \n  filter(pval.exposure < 0.01) %>%\n  clump_data(.,\n  clump_kb = 10000,\n  clump_r2 = 0.001,\n  clump_p1 = 1,\n  clump_p2 = 1,\n  pop = \"EUR\"\n)\n\nexposure1_dat <- filter(exposure1_clump, pval.exposure < 5e-8)\n\n# Clump HDL\nexposure2_clump <- exposure2 %>% \n  filter(pval.exposure < 0.01) %>%\n  clump_data(.,\n  clump_kb = 10000,\n  clump_r2 = 0.001,\n  clump_p1 = 1,\n  clump_p2 = 1,\n  pop = \"EUR\"\n)\n\nexposure2_dat <- filter(exposure2_clump, pval.exposure < 5e-8)\n```\n:::\n\n\n*Perform clumping to obtain independent genome-wide significant variants for each exposure.* This step involves identifying the SNPs that are independently associated with each exposure and are significant at the genome-wide level.\n\nThere are 79 and 89 independent genome-wide significant SNPS for LDL and HDL respectivly.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Combine Exposures\"}\n## Make list of distinct SNPs from the exposures independent GWS snps \nmvmr_snps <- bind_rows(\n  select(exposure1_dat, SNP), \n  select(exposure2_dat, SNP), \n) %>%\n  distinct(SNP) %>%\n  pull(SNP)\n\n## extract combined SNP list from exposure datasets \ncomb_exp <- bind_rows(\n  exposure1 %>% filter(SNP %in% mvmr_snps),\n  exposure2 %>% filter(SNP %in% mvmr_snps),\n)\n```\n:::\n\n\n*Combine the exposure SNP lists and extract all the SNPs from each exposure.* This step combines the lists of SNPs for each exposure and extracts all the SNPs that are present in each exposure.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Combine Exposures\"}\n## Unique SNP ids across exposures\nexp_snp_list <- full_join(\n  select(exposure1_dat, SNP, exposure), \n  select(exposure2_dat, SNP, exposure), \n  by = 'SNP'\n)\n\nexp1_unq_snps <- filter(exp_snp_list, !is.na(exposure.x) & is.na(exposure.y)) %>% nrow()\nexp2_unq_snps <- filter(exp_snp_list, !is.na(exposure.y) & is.na(exposure.x)) %>% nrow()\nboth_unq_snps <- filter(exp_snp_list, !is.na(exposure.y) & !is.na(exposure.x)) %>% nrow()\n```\n:::\n\n\nThere are 164 unique SNPs across the LDL and HDL SNP list - 75 unique to LDL, 85 to HDL, and 4 that are shared.\n\nExtracting these 164 SNPs from the LDL and HDL SumStats we get the following count of genome-wide significant SNPs across both traits.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Combined Exposure SNPs\"}\n## exposure and outcome snps lists \ncomb_exp_out <- bind_rows(\n  exposure1 %>% filter(SNP %in% mvmr_snps) %>% \n    rename(pval = pval.exposure, trait = exposure, chr = chr.exposure, pos = pos.exposure), \n  exposure2 %>% filter(SNP %in% mvmr_snps) %>% \n    rename(pval = pval.exposure, trait = exposure, chr = chr.exposure, pos = pos.exposure), \n  outcome %>% filter(SNP %in% mvmr_snps) %>% \n    rename(pval = pval.outcome, trait = outcome, chr = chr.outcome, pos = pos.outcome)\n)\n\n## How many SNPs are GWS across the exposures \ncomb_exp_wide <- comb_exp_out %>%\n   arrange(chr, pos) %>%\n   select(SNP, trait, pval) %>%\n   pivot_wider(names_from = trait, values_from = pval) %>%\n   mutate(pval.exposure = pmin(LDL, HDL, na.rm = T))\n\ncomb_exp_wide %>% count(LDL < 5e-8, HDL < 5e-8)  %>%\n  gt() \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"mtpenrluvp\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#mtpenrluvp .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mtpenrluvp .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mtpenrluvp .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mtpenrluvp .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mtpenrluvp .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mtpenrluvp .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mtpenrluvp .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mtpenrluvp .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mtpenrluvp .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mtpenrluvp .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mtpenrluvp .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mtpenrluvp .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mtpenrluvp .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mtpenrluvp .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mtpenrluvp .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mtpenrluvp .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mtpenrluvp .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mtpenrluvp .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mtpenrluvp .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mtpenrluvp .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mtpenrluvp .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mtpenrluvp .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mtpenrluvp .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mtpenrluvp .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mtpenrluvp .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mtpenrluvp .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mtpenrluvp .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mtpenrluvp .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mtpenrluvp .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mtpenrluvp .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mtpenrluvp .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mtpenrluvp .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mtpenrluvp .gt_left {\n  text-align: left;\n}\n\n#mtpenrluvp .gt_center {\n  text-align: center;\n}\n\n#mtpenrluvp .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mtpenrluvp .gt_font_normal {\n  font-weight: normal;\n}\n\n#mtpenrluvp .gt_font_bold {\n  font-weight: bold;\n}\n\n#mtpenrluvp .gt_font_italic {\n  font-style: italic;\n}\n\n#mtpenrluvp .gt_super {\n  font-size: 65%;\n}\n\n#mtpenrluvp .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#mtpenrluvp .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mtpenrluvp .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mtpenrluvp .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mtpenrluvp .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mtpenrluvp .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mtpenrluvp .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"LDL &amp;lt; 5e-08\">LDL &lt; 5e-08</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"HDL &amp;lt; 5e-08\">HDL &lt; 5e-08</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">FALSE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"n\" class=\"gt_row gt_right\">76</td></tr>\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">FALSE</td>\n<td headers=\"n\" class=\"gt_row gt_right\">64</td></tr>\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"n\" class=\"gt_row gt_right\">24</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n*Identify proxy variants for any SNPs that are missing in each exposure.* This step involves identifying proxy variants for any SNPs that are not present in each exposure dataset. This is necessary to ensure that the exposure datasets are complete and that all relevant SNPs are included in the analysis.\n\n::: {.callout-note}\nThere are no missing variants between the LDL &HDL SumStats, as such there is no need identify proxy variants\n:::\n\n*Perform LD clumping on the combined SNP list to retain indepdent SNPs.* This step is performed to reduce the risk of spurious results arising due to multi-collinearity by including correlated SNPs. LD clumping identifies lead SNPs in each locus and discards the remaining SNPs that are in linkage disequilibrium with them.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Clump Combined Exposures\"}\n## Do another round of LD clumping \nclump_comb_exp<- comb_exp_wide %>% \n  clump_data(.,\n  clump_kb = 10000,\n  clump_r2 = 0.001,\n  clump_p1 = 1,\n  clump_p2 = 1,\n  pop = \"EUR\"\n)\n\ncomb_exp_independent <- comb_exp %>% filter(SNP %in% clump_comb_exp$SNP) \n```\n:::\n\n\nDue to the high correlation among genetic variants, the GWAS of HDL and LDL may identify loci in the same genomic region. After LD clumping on the smallest p-value from the exposures, we retained 272 of the initial 164 SNPs, ensuring that we included only independent variants in the analysis.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"zskmtuvrag\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#zskmtuvrag .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zskmtuvrag .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zskmtuvrag .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zskmtuvrag .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zskmtuvrag .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zskmtuvrag .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zskmtuvrag .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zskmtuvrag .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zskmtuvrag .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zskmtuvrag .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zskmtuvrag .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zskmtuvrag .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zskmtuvrag .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zskmtuvrag .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zskmtuvrag .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zskmtuvrag .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zskmtuvrag .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zskmtuvrag .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zskmtuvrag .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zskmtuvrag .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zskmtuvrag .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zskmtuvrag .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zskmtuvrag .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zskmtuvrag .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zskmtuvrag .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zskmtuvrag .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zskmtuvrag .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zskmtuvrag .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zskmtuvrag .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zskmtuvrag .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zskmtuvrag .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zskmtuvrag .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zskmtuvrag .gt_left {\n  text-align: left;\n}\n\n#zskmtuvrag .gt_center {\n  text-align: center;\n}\n\n#zskmtuvrag .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zskmtuvrag .gt_font_normal {\n  font-weight: normal;\n}\n\n#zskmtuvrag .gt_font_bold {\n  font-weight: bold;\n}\n\n#zskmtuvrag .gt_font_italic {\n  font-style: italic;\n}\n\n#zskmtuvrag .gt_super {\n  font-size: 65%;\n}\n\n#zskmtuvrag .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#zskmtuvrag .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zskmtuvrag .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zskmtuvrag .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zskmtuvrag .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zskmtuvrag .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zskmtuvrag .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"LDL &amp;lt; 5e-08\">LDL &lt; 5e-08</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"HDL &amp;lt; 5e-08\">HDL &lt; 5e-08</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">FALSE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"n\" class=\"gt_row gt_right\">66</td></tr>\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">FALSE</td>\n<td headers=\"n\" class=\"gt_row gt_right\">57</td></tr>\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"n\" class=\"gt_row gt_right\">13</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n### Extract Outcomes\n*Extract exposures SNPs from the outcome GWAS.* This step involves extracting the SNPs that are associated with the exposures from the genome-wide association study of the outcome.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Extract Exposure SNPs from Outcome\"}\n# extract exposure SNPs present in outcome\noutcome_clump <- semi_join(\n  outcome, comb_exp_independent, by = \"SNP\"\n)\n\n# Exposure SNPs not present in outomce\noutcome_wo_snps <- anti_join(\n  comb_exp_independent, outcome, by = \"SNP\"\n) %>%\n  distinct(SNP)\n```\n:::\n\n\nOf the 272 exposures SNPs, 135 are available in the AD SumStats - with 1 variant missing.\n\n::: {.callout-note}\nOne issue to be aware of is that 3 of the exposure SNPs are GWS for AD and are violating the [exclusion restriction assumption](https://mr-dictionary.mrcieu.ac.uk/term/exclusion-restriction/).\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"idkhbtygdq\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#idkhbtygdq .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#idkhbtygdq .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#idkhbtygdq .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#idkhbtygdq .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#idkhbtygdq .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#idkhbtygdq .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#idkhbtygdq .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#idkhbtygdq .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#idkhbtygdq .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#idkhbtygdq .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#idkhbtygdq .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#idkhbtygdq .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#idkhbtygdq .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#idkhbtygdq .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#idkhbtygdq .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#idkhbtygdq .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#idkhbtygdq .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#idkhbtygdq .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#idkhbtygdq .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#idkhbtygdq .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#idkhbtygdq .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#idkhbtygdq .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#idkhbtygdq .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#idkhbtygdq .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#idkhbtygdq .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#idkhbtygdq .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#idkhbtygdq .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#idkhbtygdq .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#idkhbtygdq .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#idkhbtygdq .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#idkhbtygdq .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#idkhbtygdq .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#idkhbtygdq .gt_left {\n  text-align: left;\n}\n\n#idkhbtygdq .gt_center {\n  text-align: center;\n}\n\n#idkhbtygdq .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#idkhbtygdq .gt_font_normal {\n  font-weight: normal;\n}\n\n#idkhbtygdq .gt_font_bold {\n  font-weight: bold;\n}\n\n#idkhbtygdq .gt_font_italic {\n  font-style: italic;\n}\n\n#idkhbtygdq .gt_super {\n  font-size: 65%;\n}\n\n#idkhbtygdq .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#idkhbtygdq .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#idkhbtygdq .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#idkhbtygdq .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#idkhbtygdq .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#idkhbtygdq .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#idkhbtygdq .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"LDL &amp;lt; 5e-08\">LDL &lt; 5e-08</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"HDL &amp;lt; 5e-08\">HDL &lt; 5e-08</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"AD &amp;lt; 5e-08\">AD &lt; 5e-08</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">FALSE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"AD < 5e-08\" class=\"gt_row gt_center\">FALSE</td>\n<td headers=\"n\" class=\"gt_row gt_right\">65</td></tr>\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">FALSE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"AD < 5e-08\" class=\"gt_row gt_center\">NA</td>\n<td headers=\"n\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">FALSE</td>\n<td headers=\"AD < 5e-08\" class=\"gt_row gt_center\">FALSE</td>\n<td headers=\"n\" class=\"gt_row gt_right\">55</td></tr>\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">FALSE</td>\n<td headers=\"AD < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"n\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"AD < 5e-08\" class=\"gt_row gt_center\">FALSE</td>\n<td headers=\"n\" class=\"gt_row gt_right\">12</td></tr>\n    <tr><td headers=\"LDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"HDL < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"AD < 5e-08\" class=\"gt_row gt_center\">TRUE</td>\n<td headers=\"n\" class=\"gt_row gt_right\">1</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n*Identify proxy variants for any SNPs that missing in the outcome.* This step involves identifying proxy variants for any SNPs that are not present in the outcome dataset. This is necessary to ensure that the outcome dataset is complete and that all relevant SNPs are included in the analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Extract proxy SNPs for outcome\"}\n# Use LDLinkR to identify proxy snps\nLDproxy_batch(outcome_wo_snps, \n        pop = \"CEU\", \n        r2d = \"r2\", \n        token = 'a6deee62cc4a', \n        append = TRUE,\n        genome_build = \"grch37\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nSubmitting request for query variant rs2729816.\nChecking status of server...Combined file for all query variants saved to:\n/Users/sheaandrews/gitcode/MR-tutorial/combined_query_snp_list_grch37.txt\n```\n:::\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Extract proxy SNPs for outcome\"}\nsystem(\"mv combined_query_snp_list_grch37.txt data/mvmr_proxy_snps.txt\")\n\n# Munge proxy snp file\noutcome_dat <- munge_proxies(\"data/mvmr_proxy_snps.txt\", outcome, outcome_clump)\n```\n:::\n\n\n### Harmonize\n*Harmonize exposure and outcome datasets.* In order to perform MR the effect of a SNP on an outcome and exposure must be harmonised to be relative to the same allele.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Harmonize exposure and outcome datasets\"}\n# Univariate MR \nmrdat <- harmonise_data(comb_exp, outcome_dat) %>%\n  as_tibble() %>%\n  filter(pval.exposure < 5e-8)\n\n## MVMR\nmvdat <- mv_harmonise_data(comb_exp, outcome_dat)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Export MVMR datasets\"}\nwrite_csv(mrdat, 'data/harmonized_mvmr_uni.csv')\nwrite_rds(mvdat, 'data/harmonized_mvmr.rds')\n```\n:::\n\n\n## MVMR Analysis\n\n::: {.cell}\n\n:::\n\n\n### TwoSampleMR\nUsing the core univariable MR methods, we observed that higher genetically predicted LDL and HDL are associated with increased and reduced risk of AD respectively. However, as with total cholesterol levels we observe significant heterogeneity suggesting that the IVW estimates are likely to be biased.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Univariable MR\"}\n## Univariate MR\nmr_res <- mr(mrdat, method_list = c(\"mr_ivw_fe\", \"mr_egger_regression\", \"mr_weighted_median\", \"mr_weighted_mode\"))\n\n# Heterogeneity statistics \nhet_res <- mr_heterogeneity(mrdat, method_list = c(\"mr_egger_regression\", \"mr_ivw\"))\n\n# Horizontal pleitropy\nplei_res <- mr_pleiotropy_test(mrdat)\n\n# Leave-one-out analysis \nres_loo <- mr_leaveoneout(mrdat, method = mr_ivw_fe) %>% as_tibble()\n\n# Single SNP anlaysis \nres_single <- mr_singlesnp(mrdat, all_method = c(\"mr_ivw_fe\", \"mr_egger_regression\", \"mr_weighted_median\", \"mr_weighted_mode\")) %>% as_tibble()\n\n# Radial MR \nradial_dat <- mrdat %>% filter(mr_keep == T) %>% dat_to_RadialMR()\nradial_res <- map(radial_dat, function(x){\n    ivw_radial(x, alpha = 0.05/nrow(x))\n  }\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Tables for MR results\"}\n## Res \nmr_res %>%\n  select(-id.exposure, -id.outcome) %>%\n  gt() %>%\n  fmt_number(\n    columns = c(\"b\", \"se\")\n  ) %>%\n  fmt_number(\n    columns = pval,\n    rows = pval > 0.001,\n    decimals = 3\n  ) %>% \n  fmt_scientific(\n    columns = pval,\n    rows = pval <= 0.001,\n    decimals = 1\n  ) \n\n### Heterogenity\nhet_res %>%\n  select(-id.exposure, -id.outcome) %>%\n  gt() %>%\n  fmt_number(\n    columns = Q\n  ) %>%\n  fmt_number(\n    columns = Q_pval,\n    rows = Q_pval > 0.001,\n    decimals = 3\n  ) %>% \n  fmt_scientific(\n    columns = Q_pval,\n    rows = Q_pval <= 0.001,\n    decimals = 1\n  ) \n\n### Pleiotropy\nplei_res %>%\n  select(-id.exposure, -id.outcome) %>%\n  gt() %>%\n  fmt_number(\n    columns = c('egger_intercept', 'se')\n  ) %>%\n  fmt_number(\n    columns = pval,\n    rows = pval > 0.001,\n    decimals = 3\n  ) %>% \n  fmt_scientific(\n    columns = pval,\n    rows = pval <= 0.001,\n    decimals = 1\n  ) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Plots for MR results\"}\nscatter_p <- mr_scatter_plot(mr_res, mrdat)\n\nfunnel_p <- mr_funnel_plot(res_single)\n\nradial_p <-  map(radial_res, function(x){\n     plot_radial(x, radial_scale = F, show_outliers = F)\n  }\n)\n\njoint_mr_p <- cowplot::plot_grid(\n  scatter_p[[1]] + labs(title = \"HDL\") + theme_bw() + theme(legend.position = 'none', text = element_text(size = 8)),\n  funnel_p[[1]] + labs(title = \"HDL\") + theme_bw() + theme(legend.position = 'none', text = element_text(size = 8)), \n  radial_p[[1]] + labs(title = \"HDL\") + coord_fixed(ratio=0.25) + theme(legend.position = 'none', text = element_text(size = 6)), \n  scatter_p[[2]] + labs(title = \"LDL\") + theme_bw() + theme(legend.position = 'none', text = element_text(size = 8)), \n  funnel_p[[2]] + labs(title = \"LDL\") + theme_bw() + theme(legend.position = 'none', text = element_text(size = 8)),\n  radial_p[[2]] + labs(title = \"LDL\") + coord_fixed(ratio=0.25) + theme(legend.position = 'none', text = element_text(size = 6))\n  )\n\n\nlegend_scatter <- cowplot::get_legend(\n  # create some space to the left of the legend\n  scatter_p[[1]] + theme(legend.box.margin = margin(12, 12, 12, 12))\n)\n\n# add the legend to the row we made earlier. Give it one-third of \n# the width of one plot (via rel_widths).\nscatter_out.p <- cowplot::plot_grid(joint_mr_p, legend_scatter, rel_heights = c(4, 1), nrow = 2)\n```\n:::\n\n\nExtending these analyses into a multivariable framework we are able to determine the independent effects of LDL and HDL cholesterol levels on AD. We observed that higher geneticly predicted LDL remains significantly causaly associated with increased AD risk, while the causaly effect of HDL on AD is now non-significant.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"MVMR analysis\"}\nmvmr_res <- mv_multiple(mvdat, plots = F)\nmvmr_res$result\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Tables for MVMR results\"}\n### Pleiotropy\nmvmr_res$result %>%\n  select(-id.exposure, -id.outcome) %>%\n  gt() %>%\n  fmt_number(\n    columns = c(\"b\", \"se\")\n  ) %>%\n  fmt_number(\n    columns = pval,\n    rows = pval > 0.001,\n    decimals = 3\n  ) %>% \n  fmt_scientific(\n    columns = pval,\n    rows = pval <= 0.001,\n    decimals = 1\n  ) \n```\n:::\n\n\n### MVMR package\nThe MVMR R package can be used to perform multivariable Mendelian randomization analyses, which includes heterogeneity statistics to assess the strength and validity of the instruments. Additionally, it can evaluate conditional instrument strength and pleiotropic bias.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Format for MVMR\"}\nmvmr_dat <- cbind(mvdat$exposure_beta, \n        mvdat$exposure_se, \n        mvdat$outcome_beta, \n        mvdat$outcome_se\n      ) %>%\n      as.data.frame() %>%\n      rownames_to_column() %>%\n      as.matrix()\n\nF.data <- format_mvmr(BXGs = mvmr_dat[,c(2,3)],\n                    BYG = mvmr_dat[,6],\n                    seBXGs = mvmr_dat[,c(4,5)],\n                    seBYG = mvmr_dat[,7],\n                    RSID = mvmr_dat[,1])\n\nsres <- strength_mvmr(r_input = F.data, gencov = 0)\npres <- pleiotropy_mvmr(r_input = F.data, gencov = 0)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Results for MVMR\"}\nres_mvmr <- ivw_mvmr(r_input = F.data)\n\nmvmr_out <- res_mvmr %>% \n    as.data.frame() %>%\n    rownames_to_column() %>%\n    as_tibble() %>% \n    janitor::clean_names() %>%\n    rename(exposure = rowname, b = estimate, se = std_error, p = pr_t) %>%\n    mutate(\n      exposure = ifelse(exposure == 'exposure1', 'HDL', 'LDL'), \n      outcome = 'AD',\n      method = 'IVW-MVMR'\n    ) %>%\n    relocate(outcome, method, .after = exposure)\n```\n:::\n\n\n\n## RMVMR\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Results for MVMR\"}\nF.data_rmvmr <- format_rmvmr(BXGs = mvmr_dat[,c(2,3)],\n                    BYG = mvmr_dat[,6],\n                    seBXGs = mvmr_dat[,c(4,5)],\n                    seBYG = mvmr_dat[,7],\n                    RSID = mvmr_dat[,1])\n\n\nres_rmvrm <- ivw_rmvmr(F.data_rmvmr)\nsres_rmvrm <- strength_rmvmr(F.data_rmvmr, gencov = 0)\nrmvrm_p <- plot_rmvmr(F.data_rmvmr, res_rmvrm)\n```\n:::\n\n\n### MendelianRandomization & MVMRmode Package\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Results for MVMR\"}\nMRMVInputObject <- MendelianRandomization::mr_mvinput(\n  bx = mvdat$exposure_beta, \n  bxse = mvdat$exposure_se,\n  by = mvdat$outcome_beta,\n  byse = mvdat$outcome_se,\n  snps = rownames(mvdat$exposure_beta), \n  exposure = c('HDL', 'LDL'), \n  outcome = 'AD'\n  )\n\nMRMV_ivw <- MendelianRandomization::mr_mvivw(MRMVInputObject, \n                       model=\"default\", \n                       correl=FALSE, \n                       distribution=\"normal\",\n                       alpha = 0.05)\n\nMRMV_ivw_df <- cbind(MRMV_ivw@Exposure, MRMV_ivw@Outcome, MRMV_ivw@Estimate, MRMV_ivw@StdError, MRMV_ivw@Pvalue) %>%\n  as_tibble() %>%\n  magrittr::set_colnames(c(\"Exposure\", \"Outcome\", \"b\", \"se\", \"p\")) %>%\n  mutate(method = \"MRMV-IVW\")\n\nMRMV_egger <- MendelianRandomization::mr_mvegger(MRMVInputObject, orientate = 1, correl = FALSE, distribution = \"normal\", alpha = 0.05)\n\nMRMV_egger_df <- cbind(MRMV_egger@Exposure, MRMV_egger@Outcome, MRMV_egger@Estimate, MRMV_egger@StdError.Est, MRMV_egger@Pvalue.Est) %>%\n  as_tibble() %>%\n  magrittr::set_colnames(c(\"Exposure\", \"Outcome\", \"b\", \"se\", \"p\")) %>%\n  mutate(method = \"MRMV-Egger\")\n\n\nMRMV_wme <- MendelianRandomization::mr_mvmedian( MRMVInputObject, distribution = \"normal\", alpha = 0.05, iterations = 10000, seed = 314159265 )\n\nMRMV_wme_df <- cbind(MRMV_wme@Exposure, MRMV_wme@Outcome, MRMV_wme@Estimate, MRMV_wme@StdError, MRMV_wme@Pvalue) %>%\n  as_tibble() %>%\n  magrittr::set_colnames(c(\"Exposure\", \"Outcome\", \"b\", \"se\", \"p\")) %>%\n  mutate(method = \"MRMV-WME\")\n\n\nMRMV_wbe_res <- MVMRmode::mv_mrmode(Bout = mvdat$outcome_beta, \n                    Bexp = mvdat$exposure_beta, \n                    SEout = mvdat$outcome_se, \n                    SEexp = mvdat$exposure_se, \n                    Psi=0, CIMin = NA, CIMax = NA, CIStep = 0.001, alpha = 0.05, \n                    residual=\"IVW\",Mode=\"CM\",weighting = \"weighted\", stderror = \"simple\", \n                    phi = 1,distribution = \"normal\",iterations = 10000)\n\nMRMV_wbe_df <- as_tibble(MRMV_wbe_res) %>%\n  rename(b = Estimate, p = Pvalue) %>%\n  mutate(Exposure = c(\"LDL\", \"HDL\"), \n         Outcome = \"AD\", \n         method = 'MRMV_WBE') %>%\n  mutate_if(is.double, as.character)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Results for MVMR\"}\nMRMV_out <- bind_rows(\n    MRMV_ivw_df, MRMV_egger_df, MRMV_wme_df, MRMV_wbe_df\n  ) %>%\n  relocate(method, .after = Outcome) %>%\n  select(Exposure, Outcome, method, b, se, p) %>%\n  mutate_at(vars(b, se, p), as.double)\n\nwrite_csv(MRMV_out, 'results/mvmr_sensetivity_results.csv')\n\nMRMV_out %>%\n  pivot_wider(names_from = Exposure, values_from = c('b', 'se', 'p')) %>%\n  relocate(se_HDL, p_HDL, .after = b_HDL) %>%\n  gt() %>%\n  fmt_number(\n    columns = c(\"b_HDL\", \"se_HDL\", \"b_LDL\", \"se_LDL\")\n  ) %>% \n  fmt_number(\n    columns = c(\"p_LDL\"),\n    rows =  p_LDL > 0.001,\n    decimals = 3\n  ) %>% \n  fmt_scientific(\n    columns = c(\"p_LDL\"),\n    rows = p_LDL <= 0.001,\n    decimals = 1\n  ) %>%\n  fmt_number(\n    columns = c(\"p_HDL\"),\n    rows = p_HDL > 0.001 ,\n    decimals = 3\n  ) %>% \n  fmt_scientific(\n    columns = c(\"p_HDL\"),\n    rows = p_HDL <= 0.001,\n    decimals = 1\n  ) %>%\n  tab_spanner(\n    label = \"HDL\",\n    columns = c(\"b_HDL\", \"se_HDL\", \"p_HDL\")\n  ) %>%\n  tab_spanner(\n    label = \"LDL\",\n    columns = c(\"b_LDL\", \"se_LDL\", \"p_LDL\")\n  ) %>%\n  cols_label(\n    b_LDL = 'b',\n    se_LDL = 'se',\n    p_LDL = 'p',\n    b_HDL = 'b',\n    se_HDL = 'se',\n    p_HDL = 'p',\n  ) %>%\n  gtsave(., 'results/tables/mvmr_res.png')\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}