{
  "hash": "230ec63a94401b2f3fdb3d683f284c2f",
  "result": {
    "markdown": "---\nformat: html\neditor: visual\neditor_options: \n  chunk_output_type: console\nexecute: \n  freeze: auto\nproject:\n  execute-dir: project\n---\n\n\n# LHC-MR\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Load R Packages\"}\nlibrary(tidyverse)    # Data wrangling \nlibrary(TwoSampleMR)  # MR \nlibrary(LDlinkR)      # LD and proxy snps\nlibrary(lhcMR)\nlibrary(gt)\n\n# Usr defined functions\nsource('scripts/misc_functions.R')\n```\n:::\n\n\n## Univariable MR\n[Introduction: insert text]\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Univariable MR\"}\n## Import harmonized data \nmr_dat <- read_csv('data/harmonized_ldl_AD_data.csv') %>%\n  mutate(\n    outcome = str_replace(outcome, '_stage123', ''), \n    # mr_keep = ifelse(gws.outcome == TRUE, TRUE, mr_keep)\n  )\n\n## MR \nmr_res <- mr(mr_dat, method_list = c(\"mr_ivw_fe\", \"mr_egger_regression\", \"mr_weighted_median\", \"mr_weighted_mode\")) %>% \n  as_tibble()\n\n## Single SNP analysis\nres_single <- mr_singlesnp(mr_dat, all_method = c(\"mr_ivw_fe\", \"mr_egger_regression\", \"mr_weighted_median\", \"mr_weighted_mode\")) %>% as_tibble()\n\n## Egger intercept for pleitropy \nres_pleio <- mr_pleiotropy_test(mr_dat)\n\n## Cochrans Q for heterogeneity \nres_het <- mr_heterogeneity(mr_dat, method_list = c(\"mr_egger_regression\", \"mr_ivw\"))\n\n# Radial MR \n# radial_dat <- mr_dat %>% filter(mr_keep == T) %>% dat_to_RadialMR()\n# radial_res <- map(radial_dat, function(x){\n#     ivw_radial(x, alpha = 0.05/nrow(x))\n#   }\n# )\n```\n:::\n\n\n\n[insert text]\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"ykkcjlerls\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#ykkcjlerls .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ykkcjlerls .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ykkcjlerls .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ykkcjlerls .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ykkcjlerls .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ykkcjlerls .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ykkcjlerls .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ykkcjlerls .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ykkcjlerls .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ykkcjlerls .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ykkcjlerls .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ykkcjlerls .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ykkcjlerls .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ykkcjlerls .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ykkcjlerls .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ykkcjlerls .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ykkcjlerls .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ykkcjlerls .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ykkcjlerls .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ykkcjlerls .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ykkcjlerls .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ykkcjlerls .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ykkcjlerls .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ykkcjlerls .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ykkcjlerls .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ykkcjlerls .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ykkcjlerls .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ykkcjlerls .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ykkcjlerls .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ykkcjlerls .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ykkcjlerls .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ykkcjlerls .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ykkcjlerls .gt_left {\n  text-align: left;\n}\n\n#ykkcjlerls .gt_center {\n  text-align: center;\n}\n\n#ykkcjlerls .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ykkcjlerls .gt_font_normal {\n  font-weight: normal;\n}\n\n#ykkcjlerls .gt_font_bold {\n  font-weight: bold;\n}\n\n#ykkcjlerls .gt_font_italic {\n  font-style: italic;\n}\n\n#ykkcjlerls .gt_super {\n  font-size: 65%;\n}\n\n#ykkcjlerls .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#ykkcjlerls .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ykkcjlerls .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ykkcjlerls .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ykkcjlerls .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ykkcjlerls .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ykkcjlerls .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nsnp\">nsnp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"b\">b</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"se\">se</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pval\">pval</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"6\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Willer2013ldl\">Willer2013ldl</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bellenguez2022load</th>\n<td headers=\"Willer2013ldl stub_1_1 method\" class=\"gt_row gt_left\">IVW</td>\n<td headers=\"Willer2013ldl stub_1_1 nsnp\" class=\"gt_row gt_right\">66</td>\n<td headers=\"Willer2013ldl stub_1_1 b\" class=\"gt_row gt_right\">−0.06</td>\n<td headers=\"Willer2013ldl stub_1_1 se\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"Willer2013ldl stub_1_1 pval\" class=\"gt_row gt_right\">0.003</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bellenguez2022load</th>\n<td headers=\"Willer2013ldl stub_1_2 method\" class=\"gt_row gt_left\">MR Egger</td>\n<td headers=\"Willer2013ldl stub_1_2 nsnp\" class=\"gt_row gt_right\">66</td>\n<td headers=\"Willer2013ldl stub_1_2 b\" class=\"gt_row gt_right\">−0.11</td>\n<td headers=\"Willer2013ldl stub_1_2 se\" class=\"gt_row gt_right\">0.06</td>\n<td headers=\"Willer2013ldl stub_1_2 pval\" class=\"gt_row gt_right\">0.062</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bellenguez2022load</th>\n<td headers=\"Willer2013ldl stub_1_3 method\" class=\"gt_row gt_left\">Weighted median</td>\n<td headers=\"Willer2013ldl stub_1_3 nsnp\" class=\"gt_row gt_right\">66</td>\n<td headers=\"Willer2013ldl stub_1_3 b\" class=\"gt_row gt_right\">−0.08</td>\n<td headers=\"Willer2013ldl stub_1_3 se\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"Willer2013ldl stub_1_3 pval\" class=\"gt_row gt_right\">0.025</td></tr>\n    <tr><th id=\"stub_1_4\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bellenguez2022load</th>\n<td headers=\"Willer2013ldl stub_1_4 method\" class=\"gt_row gt_left\">Weighted mode</td>\n<td headers=\"Willer2013ldl stub_1_4 nsnp\" class=\"gt_row gt_right\">66</td>\n<td headers=\"Willer2013ldl stub_1_4 b\" class=\"gt_row gt_right\">−0.07</td>\n<td headers=\"Willer2013ldl stub_1_4 se\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"Willer2013ldl stub_1_4 pval\" class=\"gt_row gt_right\">0.018</td></tr>\n    <tr><th id=\"stub_1_5\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Kunkle2019load</th>\n<td headers=\"Willer2013ldl stub_1_5 method\" class=\"gt_row gt_left\">IVW</td>\n<td headers=\"Willer2013ldl stub_1_5 nsnp\" class=\"gt_row gt_right\">66</td>\n<td headers=\"Willer2013ldl stub_1_5 b\" class=\"gt_row gt_right\">−0.03</td>\n<td headers=\"Willer2013ldl stub_1_5 se\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"Willer2013ldl stub_1_5 pval\" class=\"gt_row gt_right\">0.525</td></tr>\n    <tr><th id=\"stub_1_6\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Kunkle2019load</th>\n<td headers=\"Willer2013ldl stub_1_6 method\" class=\"gt_row gt_left\">MR Egger</td>\n<td headers=\"Willer2013ldl stub_1_6 nsnp\" class=\"gt_row gt_right\">66</td>\n<td headers=\"Willer2013ldl stub_1_6 b\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"Willer2013ldl stub_1_6 se\" class=\"gt_row gt_right\">0.09</td>\n<td headers=\"Willer2013ldl stub_1_6 pval\" class=\"gt_row gt_right\">0.956</td></tr>\n    <tr><th id=\"stub_1_7\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Kunkle2019load</th>\n<td headers=\"Willer2013ldl stub_1_7 method\" class=\"gt_row gt_left\">Weighted median</td>\n<td headers=\"Willer2013ldl stub_1_7 nsnp\" class=\"gt_row gt_right\">66</td>\n<td headers=\"Willer2013ldl stub_1_7 b\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"Willer2013ldl stub_1_7 se\" class=\"gt_row gt_right\">0.06</td>\n<td headers=\"Willer2013ldl stub_1_7 pval\" class=\"gt_row gt_right\">0.531</td></tr>\n    <tr><th id=\"stub_1_8\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Kunkle2019load</th>\n<td headers=\"Willer2013ldl stub_1_8 method\" class=\"gt_row gt_left\">Weighted mode</td>\n<td headers=\"Willer2013ldl stub_1_8 nsnp\" class=\"gt_row gt_right\">66</td>\n<td headers=\"Willer2013ldl stub_1_8 b\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"Willer2013ldl stub_1_8 se\" class=\"gt_row gt_right\">0.06</td>\n<td headers=\"Willer2013ldl stub_1_8 pval\" class=\"gt_row gt_right\">0.904</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"6\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Graham2021ldl\">Graham2021ldl</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_9\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bellenguez2022load</th>\n<td headers=\"Graham2021ldl stub_1_9 method\" class=\"gt_row gt_left\">IVW</td>\n<td headers=\"Graham2021ldl stub_1_9 nsnp\" class=\"gt_row gt_right\">349</td>\n<td headers=\"Graham2021ldl stub_1_9 b\" class=\"gt_row gt_right\">−0.08</td>\n<td headers=\"Graham2021ldl stub_1_9 se\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"Graham2021ldl stub_1_9 pval\" class=\"gt_row gt_right\">9.7 × 10<sup style='font-size: 65%;'>−4</sup></td></tr>\n    <tr><th id=\"stub_1_10\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bellenguez2022load</th>\n<td headers=\"Graham2021ldl stub_1_10 method\" class=\"gt_row gt_left\">MR Egger</td>\n<td headers=\"Graham2021ldl stub_1_10 nsnp\" class=\"gt_row gt_right\">349</td>\n<td headers=\"Graham2021ldl stub_1_10 b\" class=\"gt_row gt_right\">−0.10</td>\n<td headers=\"Graham2021ldl stub_1_10 se\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"Graham2021ldl stub_1_10 pval\" class=\"gt_row gt_right\">0.046</td></tr>\n    <tr><th id=\"stub_1_11\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bellenguez2022load</th>\n<td headers=\"Graham2021ldl stub_1_11 method\" class=\"gt_row gt_left\">Weighted median</td>\n<td headers=\"Graham2021ldl stub_1_11 nsnp\" class=\"gt_row gt_right\">349</td>\n<td headers=\"Graham2021ldl stub_1_11 b\" class=\"gt_row gt_right\">−0.08</td>\n<td headers=\"Graham2021ldl stub_1_11 se\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"Graham2021ldl stub_1_11 pval\" class=\"gt_row gt_right\">0.038</td></tr>\n    <tr><th id=\"stub_1_12\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bellenguez2022load</th>\n<td headers=\"Graham2021ldl stub_1_12 method\" class=\"gt_row gt_left\">Weighted mode</td>\n<td headers=\"Graham2021ldl stub_1_12 nsnp\" class=\"gt_row gt_right\">349</td>\n<td headers=\"Graham2021ldl stub_1_12 b\" class=\"gt_row gt_right\">−0.07</td>\n<td headers=\"Graham2021ldl stub_1_12 se\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"Graham2021ldl stub_1_12 pval\" class=\"gt_row gt_right\">0.202</td></tr>\n    <tr><th id=\"stub_1_13\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Kunkle2019load</th>\n<td headers=\"Graham2021ldl stub_1_13 method\" class=\"gt_row gt_left\">IVW</td>\n<td headers=\"Graham2021ldl stub_1_13 nsnp\" class=\"gt_row gt_right\">349</td>\n<td headers=\"Graham2021ldl stub_1_13 b\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"Graham2021ldl stub_1_13 se\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"Graham2021ldl stub_1_13 pval\" class=\"gt_row gt_right\">0.941</td></tr>\n    <tr><th id=\"stub_1_14\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Kunkle2019load</th>\n<td headers=\"Graham2021ldl stub_1_14 method\" class=\"gt_row gt_left\">MR Egger</td>\n<td headers=\"Graham2021ldl stub_1_14 nsnp\" class=\"gt_row gt_right\">349</td>\n<td headers=\"Graham2021ldl stub_1_14 b\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"Graham2021ldl stub_1_14 se\" class=\"gt_row gt_right\">0.08</td>\n<td headers=\"Graham2021ldl stub_1_14 pval\" class=\"gt_row gt_right\">0.992</td></tr>\n    <tr><th id=\"stub_1_15\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Kunkle2019load</th>\n<td headers=\"Graham2021ldl stub_1_15 method\" class=\"gt_row gt_left\">Weighted median</td>\n<td headers=\"Graham2021ldl stub_1_15 nsnp\" class=\"gt_row gt_right\">349</td>\n<td headers=\"Graham2021ldl stub_1_15 b\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"Graham2021ldl stub_1_15 se\" class=\"gt_row gt_right\">0.07</td>\n<td headers=\"Graham2021ldl stub_1_15 pval\" class=\"gt_row gt_right\">0.775</td></tr>\n    <tr><th id=\"stub_1_16\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Kunkle2019load</th>\n<td headers=\"Graham2021ldl stub_1_16 method\" class=\"gt_row gt_left\">Weighted mode</td>\n<td headers=\"Graham2021ldl stub_1_16 nsnp\" class=\"gt_row gt_right\">349</td>\n<td headers=\"Graham2021ldl stub_1_16 b\" class=\"gt_row gt_right\">−0.05</td>\n<td headers=\"Graham2021ldl stub_1_16 se\" class=\"gt_row gt_right\">0.08</td>\n<td headers=\"Graham2021ldl stub_1_16 pval\" class=\"gt_row gt_right\">0.582</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Univariable MR Plots\"}\n## Plots\nscatter_p <- mr_scatter_plot(mr_res, mr_dat) %>%\n  map(., function(scater_plot){\n  scater_plot + theme_bw() + \n    theme(\n      legend.position = 'none', \n      text = element_text(size = 8), \n    )\n  })\n\nfunnel_p <- mr_funnel_plot(res_single) %>%\n  map(., function(funnel_plot){\n  funnel_plot + theme_bw() + \n    theme(\n      legend.position = 'none', \n      text = element_text(size = 8), \n    )\n  })\n\nmr_legend <- cowplot::get_legend(\n  mr_scatter_plot(mr_res, mr_dat)[[1]] + theme_bw() + \n    guides(colour = guide_legend(nrow = 1)) + \n    theme(\n      text = element_text(size = 8), \n    )\n)\n\njoint_mr_p <- cowplot::plot_grid(\n  plotlist=c(scatter_p, funnel_p), \n  ncol = 2, byrow = FALSE, \n  align = 'hv'\n  )\n\nmr_p_out <- cowplot::plot_grid(\n  joint_mr_p, mr_legend,\n  ncol = 1, \n  rel_heights = c(1, 0.1)\n  )\n\nmr_p_out\n```\n\n::: {.cell-output-display}\n![](lhc_mr_files/figure-html/MR_plots-1.png){width=672}\n:::\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Univariable MR Plots\"}\n# Radial MR \n# radial_p <-  map(radial_res, function(x){\n#      plot_radial(x, radial_scale = F, show_outliers = F)\n#   }\n# )\n```\n:::\n\n\n[Pleiotropy: insert text]\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"teugqqdtsy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#teugqqdtsy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#teugqqdtsy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#teugqqdtsy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#teugqqdtsy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#teugqqdtsy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#teugqqdtsy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#teugqqdtsy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#teugqqdtsy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#teugqqdtsy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#teugqqdtsy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#teugqqdtsy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#teugqqdtsy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#teugqqdtsy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#teugqqdtsy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#teugqqdtsy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#teugqqdtsy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#teugqqdtsy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#teugqqdtsy .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#teugqqdtsy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#teugqqdtsy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#teugqqdtsy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#teugqqdtsy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#teugqqdtsy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#teugqqdtsy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#teugqqdtsy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#teugqqdtsy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#teugqqdtsy .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#teugqqdtsy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#teugqqdtsy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#teugqqdtsy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#teugqqdtsy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#teugqqdtsy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#teugqqdtsy .gt_left {\n  text-align: left;\n}\n\n#teugqqdtsy .gt_center {\n  text-align: center;\n}\n\n#teugqqdtsy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#teugqqdtsy .gt_font_normal {\n  font-weight: normal;\n}\n\n#teugqqdtsy .gt_font_bold {\n  font-weight: bold;\n}\n\n#teugqqdtsy .gt_font_italic {\n  font-style: italic;\n}\n\n#teugqqdtsy .gt_super {\n  font-size: 65%;\n}\n\n#teugqqdtsy .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#teugqqdtsy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#teugqqdtsy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#teugqqdtsy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#teugqqdtsy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#teugqqdtsy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#teugqqdtsy .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"egger_intercept\">egger_intercept</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"se\">se</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pval\">pval</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"4\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Willer2013ldl\">Willer2013ldl</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bellenguez2022load</th>\n<td headers=\"Willer2013ldl stub_1_1 egger_intercept\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"Willer2013ldl stub_1_1 se\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"Willer2013ldl stub_1_1 pval\" class=\"gt_row gt_right\">0.321</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Kunkle2019load</th>\n<td headers=\"Willer2013ldl stub_1_2 egger_intercept\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"Willer2013ldl stub_1_2 se\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"Willer2013ldl stub_1_2 pval\" class=\"gt_row gt_right\">0.688</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"4\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Graham2021ldl\">Graham2021ldl</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bellenguez2022load</th>\n<td headers=\"Graham2021ldl stub_1_3 egger_intercept\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"Graham2021ldl stub_1_3 se\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"Graham2021ldl stub_1_3 pval\" class=\"gt_row gt_right\">0.487</td></tr>\n    <tr><th id=\"stub_1_4\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Kunkle2019load</th>\n<td headers=\"Graham2021ldl stub_1_4 egger_intercept\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"Graham2021ldl stub_1_4 se\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"Graham2021ldl stub_1_4 pval\" class=\"gt_row gt_right\">0.952</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n[Heterogeneity: insert text]\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Heterogeneity\"}\n# Heterogeneity statistics \nres_het <- mr_heterogeneity(mr_dat, method_list = c(\"mr_egger_regression\", \"mr_ivw\"))\n\nres_het %>%\n  select(-id.exposure, -id.outcome, -outcome, -exposure) %>%\n  gt() %>%\n  fmt_number(\n    columns = Q\n  ) %>%\n  fmt_number(\n    columns = Q_pval,\n    rows = Q_pval > 0.001,\n    decimals = 3\n  ) %>% \n  fmt_scientific(\n    columns = Q_pval,\n    rows = Q_pval <= 0.001,\n    decimals = 1\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"yrhlkpedoe\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#yrhlkpedoe .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#yrhlkpedoe .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yrhlkpedoe .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#yrhlkpedoe .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#yrhlkpedoe .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#yrhlkpedoe .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yrhlkpedoe .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yrhlkpedoe .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#yrhlkpedoe .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#yrhlkpedoe .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#yrhlkpedoe .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#yrhlkpedoe .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#yrhlkpedoe .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#yrhlkpedoe .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#yrhlkpedoe .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#yrhlkpedoe .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#yrhlkpedoe .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#yrhlkpedoe .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yrhlkpedoe .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#yrhlkpedoe .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#yrhlkpedoe .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yrhlkpedoe .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#yrhlkpedoe .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#yrhlkpedoe .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yrhlkpedoe .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yrhlkpedoe .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#yrhlkpedoe .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#yrhlkpedoe .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yrhlkpedoe .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yrhlkpedoe .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yrhlkpedoe .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yrhlkpedoe .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yrhlkpedoe .gt_left {\n  text-align: left;\n}\n\n#yrhlkpedoe .gt_center {\n  text-align: center;\n}\n\n#yrhlkpedoe .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#yrhlkpedoe .gt_font_normal {\n  font-weight: normal;\n}\n\n#yrhlkpedoe .gt_font_bold {\n  font-weight: bold;\n}\n\n#yrhlkpedoe .gt_font_italic {\n  font-style: italic;\n}\n\n#yrhlkpedoe .gt_super {\n  font-size: 65%;\n}\n\n#yrhlkpedoe .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#yrhlkpedoe .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#yrhlkpedoe .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#yrhlkpedoe .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#yrhlkpedoe .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#yrhlkpedoe .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#yrhlkpedoe .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Q\">Q</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Q_df\">Q_df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Q_pval\">Q_pval</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">MR Egger</td>\n<td headers=\"Q\" class=\"gt_row gt_right\">163.37</td>\n<td headers=\"Q_df\" class=\"gt_row gt_right\">64</td>\n<td headers=\"Q_pval\" class=\"gt_row gt_right\">1.2 × 10<sup style='font-size: 65%;'>−10</sup></td></tr>\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">Inverse variance weighted</td>\n<td headers=\"Q\" class=\"gt_row gt_right\">165.92</td>\n<td headers=\"Q_df\" class=\"gt_row gt_right\">65</td>\n<td headers=\"Q_pval\" class=\"gt_row gt_right\">9.0 × 10<sup style='font-size: 65%;'>−11</sup></td></tr>\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">MR Egger</td>\n<td headers=\"Q\" class=\"gt_row gt_right\">111.96</td>\n<td headers=\"Q_df\" class=\"gt_row gt_right\">64</td>\n<td headers=\"Q_pval\" class=\"gt_row gt_right\">2.0 × 10<sup style='font-size: 65%;'>−4</sup></td></tr>\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">Inverse variance weighted</td>\n<td headers=\"Q\" class=\"gt_row gt_right\">112.25</td>\n<td headers=\"Q_df\" class=\"gt_row gt_right\">65</td>\n<td headers=\"Q_pval\" class=\"gt_row gt_right\">2.5 × 10<sup style='font-size: 65%;'>−4</sup></td></tr>\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">MR Egger</td>\n<td headers=\"Q\" class=\"gt_row gt_right\">683.04</td>\n<td headers=\"Q_df\" class=\"gt_row gt_right\">347</td>\n<td headers=\"Q_pval\" class=\"gt_row gt_right\">3.5 × 10<sup style='font-size: 65%;'>−24</sup></td></tr>\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">Inverse variance weighted</td>\n<td headers=\"Q\" class=\"gt_row gt_right\">684.00</td>\n<td headers=\"Q_df\" class=\"gt_row gt_right\">348</td>\n<td headers=\"Q_pval\" class=\"gt_row gt_right\">3.9 × 10<sup style='font-size: 65%;'>−24</sup></td></tr>\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">MR Egger</td>\n<td headers=\"Q\" class=\"gt_row gt_right\">487.97</td>\n<td headers=\"Q_df\" class=\"gt_row gt_right\">347</td>\n<td headers=\"Q_pval\" class=\"gt_row gt_right\">8.5 × 10<sup style='font-size: 65%;'>−7</sup></td></tr>\n    <tr><td headers=\"method\" class=\"gt_row gt_left\">Inverse variance weighted</td>\n<td headers=\"Q\" class=\"gt_row gt_right\">487.97</td>\n<td headers=\"Q_df\" class=\"gt_row gt_right\">348</td>\n<td headers=\"Q_pval\" class=\"gt_row gt_right\">1.0 × 10<sup style='font-size: 65%;'>−6</sup></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n## Importing Data\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"LD Paths\"}\n## File paths needed for the analysis\nLD.filepath = \"resources/LDscores_filtered.csv\" # LD scores\nrho.filepath = \"resources/LD_GM2_2prm.csv\" # local/SNP-specfic LD scores\n\nld = \"resources/eur_w_ld_chr/\"\nhm3 = \"resources/w_hm3.snplist\"\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Import GWAS SumStats\"}\npaths = c(\n  \"resources/Graham2021ldl.chrall.CPRA_b37.tsv.gz\",\n  \"resources/Willer2013ldl.chrall.CPRA_b37.tsv.gz\", \n  \"resources/Kunkle2019load_stage123.chrall.CPRA_b37.tsv.gz\", \n  \"resources/Bellenguez2022load.chrall.CPRA_b37.tsv.gz\"\n)\nphenotypes <- str_extract(paths, \"(?<=/).*(?=.chrall)\")\n\nss <- map(paths, function(x){\n  trait <- str_extract(x, \"(?<=/).*(?=.chrall)\")\n  \n  message(\"Imporing: \", x, \"....\")\n  ## Filter out problematic snps - MAF < 1%, MNVs, rsid, APOE region\n  ss <- read_tsv(\n    x, comment = \"##\", col_types = coltypes, # n_max = 100,\n    col_select = c(DBSNP_ID, CHROM, POS, REF, ALT, AF, BETA, SE, Z, P, N, TRAIT))  %>%\n    filter(between(AF, 0.01, 0.99)) %>%\n    filter(nchar(REF) == 1 & nchar(ALT) == 1) %>%\n    filter(!is.na(DBSNP_ID)) %>%\n    filter(!(CHROM == 19 & between(POS, 44912079, 45912079))) %>%\n    mutate(TRAIT = trait) %>%\n    rename(SNP = DBSNP_ID) \n  \n  }) %>%\n  magrittr::set_names(phenotypes)\n\nnames(exposure_ss) <- exposures\n```\n:::\n\n\n## Graham LDL - Bellenguez AD \n\n\nLHC-MR takes a long time to run, this analysis took 1.6 days.\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Merge Graham2021ldl & Bellenguez2022load\"}\n## Step 1 - Merge Data \ntraits.Graham_Bellenguez = c(\"Graham2021ldl\",\"Bellenguez2022load\")\ninput.Graham_Bellenguez = list(ss$Graham2021ldl, ss$Bellenguez2022load)\ndf.Graham_Bellenguez = merge_sumstats(\n  input.Graham_Bellenguez, traits.Graham_Bellenguez, LD.filepath, rho.filepath\n  )\n\n## Step 2: Calculating smart starting points for the likelihood optimisation\nSP_list.Graham_Bellenguez = calculate_SP(\n  df.Graham_Bellenguez, traits.Graham_Bellenguez, \n  run_ldsc=TRUE, run_MR=TRUE, \n  hm3=hm3, ld=ld,\n  nStep = 2, SP_single=3, SP_pair=50, SNP_filter=10\n  )\n\n## Step 3: Running the likelihood optimisation to estimate the parameters, followed by a block-jackknife procedure to calculate parameter-SE\nres = lhc_mr(SP_list.Graham_Bellenguez, traits.Graham_Bellenguez, \n             paral_method=\"lapply\", nCores = 1, nBlock=200)\n\n## Step 4: move results\n\nGraham2021ldl_Bellenguez2022load_dir = \"data/lhcmr/Graham2021ldl_Bellenguez2022load\"\nif (!dir.exists(Graham2021ldl_Bellenguez2022load_dir)){\n  dir.create(Graham2021ldl_Bellenguez2022load_dir)\n}else{\n  print(\"dir exists\")\n}\n\nlhcmr_output <- list.files()\nGraham2021ldl_Bellenguez2022load_files <- lhcmr_output[\n  str_detect(lhcmr_output, \"200blockJK|munge.log|FullRes|munging.log|MRresults.csv|ldsc.log|SingleTraitAnalysis|StartingPoints|SummarisedResults\")\n]\n\nfile.copy(from = Graham2021ldl_Bellenguez2022load_files,\n          to   = glue(\"{Graham2021ldl_Bellenguez2022load_dir}/{Graham2021ldl_Bellenguez2022load_files}\"))\nfile.remove(Graham2021ldl_Bellenguez2022load_files)\n```\n:::\n",
    "supporting": [
      "lhc_mr_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}