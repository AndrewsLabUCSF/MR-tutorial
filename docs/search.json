[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Mendelian Randomization Tutorial",
    "section": "",
    "text": "Preface\nMendelian randomization (MR) is a method used to infer causality between and exposure and outcome using genetic variants as instrumental variables. It is based on the idea that genetic variants, which are inherited randomly and not influenced by environmental factors or reverse causation, can be used to estimate the causal effect of an exposure on an outcome.\nThese resources aim to provide a starting point for understanding the basic concepts and methods of MR, as well as the current best practices and software tools available for conducting MR studies."
  },
  {
    "objectID": "scripts/intro.html#phenotypes",
    "href": "scripts/intro.html#phenotypes",
    "title": "1  Introduction",
    "section": "Phenotypes",
    "text": "Phenotypes\nThe following genome-wide association studies (GWAS) are used as example traits for each of the MR methods covered in this tutorial.\n\nLipids\nA GWAS of low-density lipoprotein (LDL) cholesterol, high-density lipoprotein (HDL) cholesterol, triglycerides and total cholesterol levels conducted in 188,577 individuals that identified 157 loci were associated with lipid levels.\nWiller, C. J. et al. Discovery and refinement of loci associated with lipid levels. Nat Genet 45, 1274–83 (2013).\nSummary statistics\n\nLDL Cholesterol\n\n\n\nTotal Cholesterol Manhattan\ntc_path = \"resources/Willer2013tc.chrall.CPRA_b37.tsv.gz\"\ntc_ss <- read_tsv(tc_path, comment = \"##\", col_types = coltypes, \n                        col_select = c(DBSNP_ID, CHROM, POS, REF, ALT, AF, BETA, SE, Z, P, N, TRAIT))\n\n# Filter on p < 0.5 to reduce compute\nggman(filter(tc_ss, P < 0.05 & P > 1e-100), snp = \"DBSNP_ID\", bp = \"POS\", chrom = \"CHROM\", pvalue = \"P\", relative.positions = TRUE) + \n  theme_classic()\n\n\n\n\n\n\nHDL Cholesterol\nTriglycerides\nTotal cholesterol\n\n\n\nAlzheimer’s disease\nA GWAS of Alzheimer’s disease conducted in 94,437 indivudles by the International Genomics Alzheiemr’s Project that Identified 20 genome-wide signiﬁcant loci.\nKunkle, B. W. et al. Genetic meta-analysis of diagnosed Alzheimer’s disease identifies new risk loci and implicates Aβ, tau, immunity and lipid processing. Nat Genet 51, 414–430 (2019).\nSummary statistics\n\nLate-onset Alzheimer’s disease\n\n\n\nAD Manhattan Plot\nAD_path = \"resources/Kunkle2019load_stage123.chrall.CPRA_b37.tsv.gz\"\nAD_ss <- read_tsv(AD_path, comment = \"##\",  col_types = coltypes, \n                       col_select = c(DBSNP_ID, CHROM, POS, REF, ALT, AF, BETA, SE, Z, P, N, TRAIT))\n\n# Filter on p < 0.5 to reduce compute\nggman(filter(AD_ss, P < 0.05 & P > 1e-100), snp = \"DBSNP_ID\", bp = \"POS\", chrom = \"CHROM\", pvalue = \"P\", relative.positions = TRUE) + \n  theme_classic()\n\n\n\n\n\n\n\nSumStat Standardization\nGWAS summary statistics were standardized using a Snakemake Workflow that (1) aligns effect alleles to the alternate allele on the forward strand of the human genome reference build and normalizes indels, (2) annotates variants with marker names using chromosome:position:ref:alt, 1000 Genomes rsIDs (phase III), and database-single-nucleotide polymorphism (dbSNP) rsIDs (b151) (3) where allele frequencies are missing, annotates allele frequencies using non-Finnish Europeans from gnomAD (version 2.1), and (4) convert summary statistics to VCF and TSV ﬁles.\nAndrews, S. J. et al. Causal Associations Between Modifiable Risk Factors and the Alzheimer’s Phenome. Ann Neurol 89, 54–65 (2021)."
  },
  {
    "objectID": "scripts/intro.html#reading-list",
    "href": "scripts/intro.html#reading-list",
    "title": "1  Introduction",
    "section": "Reading List",
    "text": "Reading List\nThese resources provide a good starting point for understanding the basic concepts and methods of MR, as well as the current best practices and software tools available for conducting MR studies.\n\nGenome-wide association studies\n\nUffelmann, E. et al. Genome-wide association studies. Nat Rev Methods Primers 1, 59 (2021).\nMarees, A. T. et al. A tutorial on conducting genome‐wide association studies: Quality control and statistical analysis. Int J Method Psych 27, e1608 (2018).\nMacArthur, J. A. L. et al. Workshop proceedings: GWAS summary statistics standards and sharing. Cell Genom 1, 100004 (2021).\n\n\n\nMendelian Randomization\n\nSanderson, E. et al. Mendelian randomization. Nat Rev Methods Primers 2, 6 (2022).\nDavies, N. M., Holmes, M. V. & Smith, G. D. Reading Mendelian randomisation studies: a guide, glossary, and checklist for clinicians. Bmj 362, k601 (2017).\nHemani, G. et al. The MR-Base platform supports systematic causal inference across the human phenome. Elife 7, e34408 (2018).\nSkrivankova, V. W. et al. Strengthening the Reporting of Observational Studies in Epidemiology Using Mendelian Randomization. Jama 326, 1614–1621 (2021).\nSkrivankova, V. W. et al. Strengthening the reporting of observational studies in epidemiology using mendelian randomisation (STROBE-MR): explanation and elaboration. Bmj 375, n2233 (2021).\n\n\n\nMultivariable Mendelian Randomization\n\nSanderson, E. Multivariable Mendelian Randomization and Mediation. Csh Perspect Med 11, a038984 (2020).\nCarter, A. R. et al. Mendelian randomisation for mediation analysis: current methods and challenges for implementation. Eur J Epidemiol 36, 465–478 (2021).\n\n\n\nR packages, tutorials, and databases\n\nGWAS Catalog: A database of genome-wide association studies and loci-trait associsation discovered.\nPhenoScanner: A database of human genotype-phenotype associations.\nMungeSumstats: Tutorial for standardizing GWAS summary statistics using the MungeSumstats R package.\nTwoSampleMR: Tutorial for conducting Two-Sample Mendelian randomization using the TwoSampleMR R package\nMVMR: Tutorial for conducting multivariable Mendelian ranomization using the MVMR R package.\nMendelianRandomization: Vignette for the MendelianRandomization R package.\n\nMR Dictionary: The definitive list of terms for Mendelian randomization research"
  },
  {
    "objectID": "scripts/sumstats.html",
    "href": "scripts/sumstats.html",
    "title": "2  Standardizing and harmonizing GWAS SumStats",
    "section": "",
    "text": "Two-sample MR methods require the use of summary statistics from genome-wide association studies, including single nucleotide polymorphisms (SNPs), beta coefficients, standard errors, p-values, and allele frequencies. However, the historical lack of standards for data content and file formats in GWAS summary statistics has resulted in heterogeneous data sets. To address this issue, standardizing and harmonizing the GWAS summary statistics is crucial before conducting MR analyses. The GWAS Catalog and OpenGWAS platforms have developed formats such as GWAS-SSF (Hayhurst et al. 2022) and GWAS-VCF (Lyon et al. 2021) to facilitate sharing of GWAS SumStats. Tools like MungeSumstats (Murphy et al 2021) and GWAS2VCF (Lyon et al. 2021) are available that provide rapid standardization and quality control of GWAS SumStats."
  },
  {
    "objectID": "scripts/methods.html",
    "href": "scripts/methods.html",
    "title": "Methods",
    "section": "",
    "text": "An overview of different Mendelian randomization methods for evaluating the causal effect of an exposure on an outcome."
  },
  {
    "objectID": "scripts/mr_harmonization.html#exposure-dataset",
    "href": "scripts/mr_harmonization.html#exposure-dataset",
    "title": "3  Harmonizing SumStats",
    "section": "Exposure dataset",
    "text": "Exposure dataset\nThe exposure GWAS SumStats have previously been standardized to common format, however, they need to be converted to the format required by TwoSampleMR.\n\n\nImport exposure GWAS SumStats\nexposure_path = \"resources/Willer2013tc.chrall.CPRA_b37.tsv.gz\"\nexposure_ss <- read_tsv(exposure_path, comment = \"##\", col_types = coltypes, \n                        col_select = c(DBSNP_ID, CHROM, POS, REF, ALT, AF, BETA, SE, Z, P, N, TRAIT))\n\n# Format data to TwoSampleMR format\nexposure <- exposure_ss %>%\n  format_data(.,\n    type = \"exposure\",\n    snps = NULL,\n    header = TRUE,\n    phenotype_col = \"TRAIT\",\n    snp_col = \"DBSNP_ID\",\n    beta_col = \"BETA\",\n    se_col = \"SE\",\n    eaf_col = \"AF\",\n    effect_allele_col = \"ALT\",\n    other_allele_col = \"REF\",\n    pval_col = \"P\",\n    samplesize_col = \"N\",\n    z_col = \"Z\",\n    chr_col = \"CHROM\",\n    pos_col = \"POS\",\n    log_pval = FALSE\n) %>%\n  as_tibble()\n\n\nLD clumping is performed to obtain independent SNPs. By default a stringent LD clumping procedure is conducted using a 10Mb window with an r2 of 0.001. Setting clump_p1 = 1 and clump_p2 = 1 will perform clumping on all available SNPs.\n\n\nLD clump exposure\n# Perform LD clumping on SNP data, filter SNPs to make it run faster\nexposure_clump <- exposure %>% \n  filter(pval.exposure < 0.01) %>%\n  clump_data(.,\n  clump_kb = 10000,\n  clump_r2 = 0.001,\n  clump_p1 = 1,\n  clump_p2 = 1,\n  pop = \"EUR\"\n)\n\n# Should filter here at GWS, I dont here to demonstrate proxy snps\n# exposure_dat <- filter(exposure_clump, pval.exposure < 5e-8)\nexposure_dat <- exposure_clump"
  },
  {
    "objectID": "scripts/mr_harmonization.html#outcome-datasets",
    "href": "scripts/mr_harmonization.html#outcome-datasets",
    "title": "3  Harmonizing SumStats",
    "section": "Outcome datasets",
    "text": "Outcome datasets\nSimilarly, the outcome dataset needs to be converted to the TwoSampleMR format.\n\n\nImport outcome GWAS SumStats\noutcome_path = \"resources/Kunkle2019load_stage123.chrall.CPRA_b37.tsv.gz\"\noutcome_ss <- read_tsv(outcome_path, comment = \"##\",  col_types = coltypes, \n                       col_select = c(DBSNP_ID, CHROM, POS, REF, ALT, AF, BETA, SE, Z, P, N, TRAIT))\n\n# Format outcome\noutcome <- outcome_ss %>%\n  format_data(.,\n    type = \"outcome\",\n    snps = NULL,\n    header = TRUE,\n    phenotype_col = \"TRAIT\",\n    snp_col = \"DBSNP_ID\",\n    beta_col = \"BETA\",\n    se_col = \"SE\",\n    eaf_col = \"AF\",\n    effect_allele_col = \"ALT\",\n    other_allele_col = \"REF\",\n    pval_col = \"P\",\n    samplesize_col = \"N\",\n    z_col = \"Z\",\n    chr_col = \"CHROM\",\n    pos_col = \"POS\",\n    log_pval = FALSE\n) %>%\n  as_tibble()\n\n\n\nLD Proxy SNPs\n\n\nIdentify Proxy Variants\n# extract exposure SNPs present in outcome\noutcome_clump <- semi_join(\n  outcome, exposure_dat, by = \"SNP\"\n)\n\n# Exposure SNPs not present in outomce\nexp_snps_wo <- anti_join(\n  exposure_dat, outcome, by = \"SNP\"\n)\n\n# Use LDLinkR to identify proxy snps\nLDproxy_batch(exp_snps_wo$SNP, \n        pop = \"CEU\", \n        r2d = \"r2\", \n        token = 'a6deee62cc4a', \n        append = TRUE,\n        genome_build = \"grch37\")\nsystem(\"mv combined_query_snp_list_grch37.txt data/exposure_outcome_proxy_snps.txt\")\n\n\n# Munge proxy snp file\noutcome_dat <- munge_proxies(\"data/exposure_outcome_proxy_snps.txt\", outcome, outcome_clump)"
  },
  {
    "objectID": "scripts/mr_harmonization.html#harmonize-exposure---outcome-datasets",
    "href": "scripts/mr_harmonization.html#harmonize-exposure---outcome-datasets",
    "title": "3  Harmonizing SumStats",
    "section": "Harmonize Exposure - Outcome Datasets",
    "text": "Harmonize Exposure - Outcome Datasets\n\n\nHarmonize\nmr_dat <- harmonise_data(exposure_dat, outcome_dat, action = 2) %>% as_tibble() %>%\n  filter(pval.exposure < 5e-8)\n\n\n\n\nExport harmonized data\nwrite_csv(mr_dat, 'data/harmonized_data.csv')"
  }
]